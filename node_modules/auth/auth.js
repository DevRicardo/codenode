var DB = require('database/database');
var Database = new DB();


//----------------------------------------------------------
// 	DEFINICION DEL MODULO
//

var Auth = function(){

}


/***********************************************
*           QUERYS AUTENTICATION               *
************************************************/

//----------------------------------------------------------
// 	VERIFICAR CREDENCIALES DEL USUARIO
//
Auth.prototype.check = function(dataUser, callback){
    
    var SQLCHECKUSER = "SELECT * FROM users WHERE email='"+dataUser.email+"' "+
    "AND password='"+dataUser.password+"'";

    Database.runQuery(SQLCHECKUSER,function(res){
      callback(res);
    });

}

Auth.prototype.guest = function(req, res, next){

	if(req.session.user){
        next();
	}else{
        res.redirect("/");
	}

}

module.exports = Auth;

