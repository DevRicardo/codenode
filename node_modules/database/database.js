var mysql = require('mysql');
var queries = require('./queries');
var config = require('./config');

/************************************
*                                   *
* CONFIGURACION DE LA BASE DE DATOS *
*                                   *
*************************************/




var runQuery = function(Query, Data, Callback){
    
    var connection = mysql.createConnection(config.dbConfig);
    connection.connect(function(error){
        if(error) throw error;   
    });
    
    connection.query(Query, Data, function(error, res){
        if(error) throw error;
        if(Callback){    
            	
           Callback(res);
        }
    });
    // end conection
    connection.end();
}

//----------------------------------------------------------
// 	DEFINICION DEL MODULO
//

var DB = function( config ){

    config = config || {};

}

DB.prototype.getSingleData = function(data,callback){
   var Query = queries.SQLGETSINGLEDATA;
   var Data  = [data];
   runQuery(Query,Data,function(res){
      callback(res);
   });
}

DB.prototype.saveSingleData = function(data){
   var Query = queries.SQLSAVESINGLEDATA;
   var Data  = data;
   runQuery(Query,Data);
}

module.exports = DB;
